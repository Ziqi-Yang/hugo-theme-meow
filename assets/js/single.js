// TOC sync position ========================================
// Currently only highlight the heading in viewport(only the heading, no content)
// the html generated by hugo has a poor structure for highlight current toc position
var tocNav = document.getElementById("TableOfContents");
var tocLinksLi = tocNav.getElementsByTagName("a");

// currently, hugo cannot render markdown files into nested html structure, but org files can
// https://github.com/gohugoio/hugo/issues/10039
window.addEventListener('DOMContentLoaded', () => {
		const observer = new IntersectionObserver(entries => {
				entries.forEach(entry => {
						const id = entry.target.getAttribute('id');
						// let parentNode = entry.parentElement;
						let tocEntry = tocNav.querySelector(`a[href="#${id}"]`).parentElement;
						if (entry.intersectionRatio > 0) {
								tocEntry.classList.add('toc-active');
						} else {
								tocEntry.classList.remove('toc-active');
						}
				});
		});

		const headings = document.querySelectorAll("h1, h2, h3");
		headings.forEach((section) => {
				observer.observe(section);
		});
});
